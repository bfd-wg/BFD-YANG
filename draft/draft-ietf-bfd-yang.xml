<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="no"?>
<?rfc tocdepth="6"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<rfc category="std" docName="draft-ietf-bfd-yang-12.txt" ipr="trust200902">
  <front>
    <title abbrev="BFD YANG">YANG Data Model for Bidirectional Forwarding
    Detection (BFD)</title>

    <author fullname="Reshad Rahman" initials="R." role="editor"
            surname="Rahman">
      <organization>Cisco Systems</organization>

      <address>
        <postal>
          <street/>

          <city/>

          <region/>

          <code/>

          <country>Canada</country>
        </postal>

        <email>rrahman@cisco.com</email>
      </address>
    </author>

    <author fullname="Lianshu Zheng" initials="L." role="editor"
            surname="Zheng">
      <organization>Huawei Technologies</organization>

      <address>
        <postal>
          <street/>

          <city/>

          <region/>

          <code/>

          <country>China</country>
        </postal>

        <email>vero.zheng@huawei.com</email>
      </address>
    </author>

    <author fullname="Mahesh Jethanandani" initials="M." role="editor"
            surname="Jethanandani">
      <address>
        <postal>
          <street/>

          <city/>

          <region/>

          <code/>

          <country/>
        </postal>

        <email>mjethanandani@gmail.com</email>
      </address>
    </author>

    <author fullname="Santosh Pallagatti" initials="S." surname="Pallagatti">
      <address>
        <postal>
          <street/>

          <city/>

          <region/>

          <code/>

          <country>India</country>
        </postal>

        <email>santosh.pallagatti@gmail.com</email>
      </address>
    </author>

    <author fullname="Greg Mirsky" initials="G." surname="Mirsky">
      <organization>ZTE Corporation</organization>

      <address>
        <postal>
          <street/>

          <city/>

          <region/>

          <code/>

          <country/>
        </postal>

        <email>gregimirsky@gmail.com</email>
      </address>
    </author>

    <date day="19" month="March" year="2018"/>

    <abstract>
      <t>This document defines a YANG data model that can be used to configure
      and manage Bidirectional Forwarding Detection (BFD).</t>

      <t>The YANG modules in this document conform to the Network Management
      Datastore Architecture (NMDA).</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>This document defines a YANG data model that can be used to configure
      and manage Bidirectional Forwarding Detection <xref
      target="RFC5880">(BFD) </xref>. BFD is a network protocol which is used
      for liveness detection of arbitrary paths between systems. Some examples
      of different types of paths over which we have BFD:</t>

      <t>1) Two systems directly connected via IP. This is known as BFD over
      single-hop IP, a.k.a. <xref target="RFC5881">BFD for IPv4 and IPv6
      </xref></t>

      <t>2) Two systems connected via multiple hops as described in <xref
      target="RFC5883">BFD for Multiple Hops.</xref></t>

      <t>3) Two systems connected via MPLS Label Switched Paths (LSPs) as
      described in <xref target="RFC5884">BFD for MPLS LSP </xref></t>

      <t>4) Two systems connected via a Link Aggregation Group (LAG) interface
      as described in <xref target="RFC7130">BFD on LAG Interfaces </xref></t>

      <t>5) Two systems connected via pseudowires (PWs), this is known as
      Virtual Circuit Connectivity Verification (VCCV) as described in <xref
      target="RFC5885">BFD for PW VCCV </xref>. This is not addressed in this
      document.</t>

      <t>BFD typically does not operate on its own. Various control protocols,
      also known as BFD clients, use the services provided by BFD for their
      own operation as described in <xref target="RFC5882">Generic Application
      of BFD </xref>. The obvious candidates which use BFD are those which do
      not have "hellos" to detect failures, e.g. static routes, and routing
      protocols whose "hellos" do not support sub-second failure detection,
      e.g. OSPF and IS-IS.</t>

      <t>The YANG modules in this document conform to the Network Management
      Datastore Architecture (NMDA) <xref
      target="I-D.ietf-netmod-revised-datastores">Network Management Datastore
      Architecture </xref>. This means that the data models do not have
      separate top-level or sibling containers for configuration and
      operational state data.</t>

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in BCP 14 <xref
        target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
        appear in all capitals, as shown here.</t>
      </section>
      <section title="Tree Diagrams">
         <t>This document uses the graphical representation of data models defined in 
            <xref target="I-D.ietf-netmod-yang-tree-diagrams"/>.</t>
      </section>
    </section>

    <section anchor="DESIGN-DATA" title="Design of the Data Model">
      <t>Since BFD is used for liveliness detection of various forwarding
      paths, there is no uniform key to identify a BFD session. So the BFD
      data model is split in multiple YANG modules where each module
      corresponds to one type of forwarding path. For example, BFD for IP
      single-hop is in one YANG module and BFD for MPLS-TE is in another YANG
      module. The main difference between these modules is how a BFD session
      is uniquely identified, i.e the key for the list containing the BFD
      sessions for that forwarding path. To avoid duplication of BFD
      definitions, we have common types and groupings which are used by all
      the modules.</t>

      <t>A new control-plane protocol "bfdv1" is defined and a "bfd" container
      is created under control-plane-protocol as specified in <xref
      target="I-D.ietf-netmod-rfc8022bis">"A YANG Data Model for Routing
      Management (NMDA Version)"</xref>. This new "bfd" container is augmented
      by all the YANG modules for their respective specific information:<list
          style="numbers">
          <t>ietf-bfd-ip-sh.yang augments
          "/routing/control-plane-protocols/control-plane-protocol/bfd/" with
          the "ip-sh" container for BFD sessions over IP single-hop.</t>

          <t>ietf-bfd-ip-mh.yang augments
          "/routing/control-plane-protocols/control-plane-protocol/bfd/" with
          the "ip-mh" container for BFD sessions over IP multi-hop.</t>

          <t>ietf-bfd-lag.yang augments
          "/routing/control-plane-protocols/control-plane-protocol/bfd/" with
          the "lag" container for BFD sessions over LAG.</t>

          <t>ietf-bfd-mpls.yang augments
          "/routing/control-plane-protocols/control-plane-protocol/bfd/" with
          the "mpls" container for BFD over MPLS LSPs.</t>

          <t>ietf-bfd-mpls-te.yang augments
          "/routing/control-plane-protocols/control-plane-protocol/bfd/" with
          the "mpls-te" container for BFD over MPLS-TE.</t>
        </list></t>

      <t>BFD can operate in the following contexts: <list style="numbers">
          <t>At the network device level</t>

          <t>In Logical Network Elements as described in <xref
          target="I-D.ietf-rtgwg-lne-model">YANG Logical Network
          Element</xref></t>

          <t>In Network Instances as described in <xref
          target="I-D.ietf-rtgwg-ni-model">YANG Logical Network
          Element</xref></t>
        </list> When used at the network device level, the BFD YANG model is
        used "as-is". When the BFD YANG model is used in a Logical Network
        Element or in a Network Instance, then the BFD YANG model augments
        the mounted routing model for the Logical Network Element or the
        Network Instance.</t>

      <section anchor="CFG-MODEL" title="Design of Configuration Model">
        <t>The configuration model consists mainly of the parameters specified
        in <xref target="RFC5880">BFD</xref>. Some examples are desired
        minimum transmit interval, required minimum receive interval,
        detection multiplier, etc</t>

        <t>BFD clients are applications that use BFD for fast detection of
        failures. Some implementations have BFD session configuration under
        the BFD clients. For example, BFD session configuration under routing
        applications such as OSPF, IS-IS, BGP etc. Other implementations have
        BFD session configuration centralized under BFD, i.e. outside the
        multiple BFD clients.</t>

        <t>The BFD parameters of interest to a BFD client are mainly the
        multiplier and interval(s) since those parameters impact the
        convergence time of the BFD clients when a failure occurs. Other
        parameters such as BFD authentication are not specific to the
        requirements of the BFD client. Ideally all configuration should be
        centralized under BFD. However, this is a problem for clients of BFD
        which auto-discover their peers. For example, IGPs do not have the
        peer address configured, instead the IGP is enabled on an interface
        and the IGP peers are auto-discovered. So for an operator to configure
        BFD to an IGP peer, the operator would first have to determine the
        peer addresses. And when a new peer is discovered, BFD configuration
        would need to be added. To avoid this issue, we define grouping
        client-cfg-parms in <xref target="BFD-TYPES"/> for BFD clients to
        configure BFD: this allows BFD clients such as the IGPs to have
        configuration (multiplier and intervals) for the BFD sessions they
        need. For example, when a new IGP peer is discovered, the IGP would
        create a BFD session to the newly discovered peer and similarly when
        an IGP peer goes away, the IGP would remove the BFD session to that
        peer. The mechanism how the BFD sessions are created and removed by
        the BFD clients is outside the scope of this document, but typically
        this would be done by use of an API implemented by the BFD module on
        the system. For BFD clients which create BFD sessions via their own
        configuration, authentication parameters (if required) are still
        specified in BFD.</t>

        <section anchor="BFD-COMMON-CFG"
                 title="Common BFD configuration parameters">
          <t>The basic BFD configuration parameters are: <list hangIndent="8"
              style="hanging">
              <t hangText="local-multiplier"><vspace/>This is the detection
              time multiplier as defined in <xref
              target="RFC5880">BFD</xref>.</t>

              <t hangText="desired-min-tx-interval"><vspace/>This is the
              Desired Min TX Interval as defined in <xref
              target="RFC5880">BFD</xref>.</t>

              <t hangText="required-min-rx-interval"><vspace/>This is the
              Required Min RX Interval as defined in <xref
              target="RFC5880">BFD</xref>.</t>
            </list>Although <xref target="RFC5880">BFD</xref> allows for
          different values for transmit and receive intervals, some
          implementations allow users to specify just one interval which is
          used for both transmit and receive intervals or separate values for
          transmit and receive intervals. The BFD YANG model supports this:
          there is a choice between "min-interval", used for both transmit and
          receive intervals, and "desired-min-tx-interval" and
          "required-min-rx-interval". This is supported via a grouping which
          is used by the YANG modules for the various forwarding paths.</t>

          <t>For BFD authentication we have: <list hangIndent="8"
              style="hanging">
              <t hangText="key-chain"><vspace/>This is a reference to
              key-chain defined in <xref target="RFC8177">YANG Data Model for
              Key Chains </xref>. The keys, cryptographic algorithms, key
              lifetime etc are all defined in the key-chain model.</t>

              <t hangText="meticulous"><vspace/>This enables meticulous mode
              as per <xref target="RFC5880">BFD </xref>.</t>
            </list></t>
        </section>

        <section anchor="IP-SH-CFG" title="Single-hop IP">
          <t>For single-hop IP, there is an augment of the "bfd" data node in
          <xref target="DESIGN-DATA"/>. The "ip-sh" node contains a list of IP
          single-hop sessions where each session is uniquely identified by the
          interface and destination address pair. For the configuration
          parameters we use what is defined in <xref
          target="BFD-COMMON-CFG"/>. The "ip-sh" node also contains a list of
          interfaces, this is used to specify authentication parameters for
          BFD sessions which are created by BFD clients, see <xref
          target="CFG-MODEL"/>.</t>

          <t><xref target="RFC5880"/> and <xref target="RFC5881"/> do not
          specify whether echo function is continuous or on demand. Therefore
          the mechanism used to start and stop echo function is implementation
          specific and should be done by augmentation: <list>
              <t>1) Configuration. This is suitable for continuous echo
              function. An example is provided in <xref
              target="ECHO-CONFIG"/>.</t>

              <t>2) RPC. This is suitable for on-demand echo function.</t>
            </list></t>
        </section>

        <section title="Multihop IP">
          <t>For multihop IP, there is an augment of the "bfd" data node in
          <xref target="DESIGN-DATA"/>.</t>

          <t>Because of multiple paths, there could be multiple multihop IP
          sessions between a source and a destination address. We identify
          this as a "session-group". The key for each "session-group" consists
          of: <list hangIndent="8" style="hanging">
              <t hangText="source address"><vspace/>Address belonging to the
              local system as per <xref target="RFC5883">BFD for Multiple Hops
              </xref></t>

              <t hangText="destination address"><vspace/>Address belonging to
              the remote system as per <xref target="RFC5883">BFD for Multiple
              Hops </xref></t>
            </list></t>

          <t>For the configuration parameters we use what is defined in <xref
          target="BFD-COMMON-CFG"/></t>

          <t>Here are some extra parameters: <list hangIndent="8"
              style="hanging">
              <t hangText="tx-ttl"><vspace/>TTL of outgoing BFD control
              packets.</t>

              <t hangText="rx-ttl"><vspace/>Minimum TTL of incoming BFD
              control packets.</t>
            </list></t>
        </section>

        <section anchor="BFD-MPLS-TE-CFG"
                 title="MPLS Traffic Engineering Tunnels">
          <t>For MPLS-TE tunnels, BFD is configured under the MPLS-TE tunnel
          since the desired failure detection parameters is a property of the
          MPLS-TE tunnel. This is achieved by augmenting the MPLS-TE data
          model in <xref target="I-D.ietf-teas-yang-te">YANG Data Model for TE
          Topologies </xref>. For BFD parameters which are specific to the TE
          application, e.g. whether to tear down the tunnel in the event of a
          BFD session failure, these parameters will be defined in the YANG
          model of the MPLS-TE application.</t>

          <t>On top of the usual BFD parameters, we have the following per
          MPLS-TE tunnel: <list hangIndent="8" style="hanging">
              <t hangText="encap"><vspace/>Encapsulation for the BFD packets:
              choice between IP, G-ACh and IP with G-ACh as per <xref
              target="RFC5586">MPLS Generic Associated Channel </xref></t>
            </list></t>

          <t>For general MPLS-TE data, "mpls-te" data node is added under the
          "bfd" node in <xref target="DESIGN-DATA"/>. Since some MPLS-TE
          tunnels are uni-directional there is no MPLS-TE configuration for
          these tunnels on the egress node (note that this does not apply to
          bi-directional MPLS-TP tunnels). The BFD parameters for the egress
          node are added under "mpls-te".</t>
        </section>

        <section title="MPLS Label Switched Paths">
          <t>Here we address MPLS LSPs whose FEC is an IP address. The "bfd"
          node in <xref target="DESIGN-DATA"/> is augmented with "mpls" which
          contains a list of sessions uniquely identified by an IP prefix.
          Because of multiple paths, there could be multiple MPLS sessions to
          an MPLS FEC. We identify this as a "session-group".</t>

          <t>Since these LSPs are uni-directional there is no LSP
          configuration on the egress node.</t>

          <t>The BFD parameters for the egress node are added under
          "mpls".</t>
        </section>

        <section title="Link Aggregation Groups">
          <t>Per <xref target="RFC7130">BFD on LAG Interfaces </xref>,
          configuring BFD on LAG consists of having micro-BFD sessions on each
          LAG member link. Since the BFD parameters are an attribute of the
          LAG, they should be under the LAG. However there is no LAG YANG
          model which we can augment. So a "lag" data node is added to the
          "bfd" node in <xref target="DESIGN-DATA"/>, the configuration is
          per-LAG: we have a list of LAGs. The destination IP address of the
          micro-BFD sessions is configured per-LAG and per address-family
          (IPv4 and IPv6)</t>
        </section>
      </section>

      <section title="Design of Operational State Model">
        <t>The operational state model contains both the overall statistics of
        BFD sessions running on the device and the per session operational
        information.</t>

        <t>The overall statistics of BFD sessions consist of number of BFD
        sessions, number of BFD sessions up etc. This information is available
        globally (i.e. for all BFD sessions) under the "bfd" node in <xref
        target="DESIGN-DATA"/> and also per type of forwarding path.</t>

        <t>For each BFD session, mainly three categories of operational state
        data are shown. The fundamental information of a BFD session such as
        the local discriminator, remote discriminator and the capability of
        supporting demand detect mode are shown in the first category. The
        second category includes a BFD session running information, e.g. the
        remote BFD state and the diagnostic code received. Another example is
        the actual transmit interval between the control packets, which may be
        different from the desired minimum transmit interval configured, is
        shown in this category. Similar examples are actual received interval
        between the control packets and the actual transmit interval between
        the echo packets. The third category contains the detailed statistics
        of the session, e.g. when the session transitioned up/down and how
        long it has been in that state.</t>

        <t>For some path types, there may be more than 1 session on the
        virtual path to the destination. For example, with IP multihop and
        MPLS LSPs, there could be multiple BFD sessions from the source to the
        same destination to test the various paths (ECMP) to the destination.
        This is represented by having multiple "sessions" under each
        "session-group".</t>
      </section>

      <section title="Notifications">
        <t>This YANG model defines notifications to inform end-users of
        important events detected during the protocol operation. Pair of local
        and remote discriminator identifies a BFD session on local system.
        Notifications also give more important details about BFD sessions;
        e.g. new state, time in previous state, network-instance and the
        reason that the BFD session state changed. The notifications are
        defined for each type of forwarding path but use groupings for common
        information.</t>
      </section>

      <section title="RPC Operations">
        <t>None.</t>
      </section>

      <section title="BFD top level hierarchy">
        <t>At the "bfd" node under control-plane-protocol, there is no
        configuration data, only operational state data. The operational state
        data consist of overall BFD session statistics, i.e. for BFD on all
        types of forwarding paths.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
        </figure>
      </section>

      <section title="BFD IP single-hop hierarchy">
        <t>An "ip-sh" node is added under "bfd" node in
        control-plane-protocol. The configuration and operational state data
        for each BFD IP single-hop session is under this "ip-sh" node.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-ip-sh@YYYY-MM-DD-tree.txt)

]]></artwork>
        </figure>
      </section>

      <section title="BFD IP multihop hierarchy">
        <t>An "ip-mh" node is added under the "bfd" node in
        cntrol-plane-protocol. The configuration and operational state data
        for each BFD IP multihop session is under this "ip-mh" node. In the
        operational state model we support multiple BFD multihop sessions per
        remote address (ECMP), the local discriminator is used as key.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-ip-mh@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
        </figure>
      </section>

      <section title="BFD over LAG hierarchy">
        <t>A "lag" node is added under the "bfd" node in
        control-plane-protocol. The configuration and operational state data
        for each BFD LAG session is under this "lag" node.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-lag@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
        </figure>
      </section>

      <section title="BFD over MPLS LSPs hierarchy">
        <t>An "mpls" node is added under the "bfd" node in
        control-plane-protocol. The configuration is per MPLS FEC under this
        "mpls" node. In the operational state model we support multiple BFD
        sessions per MPLS FEC (ECMP), the local discriminator is used as key.
        The "mpls" node can be used in a network device (top-level), or
        mounted in an LNE or in a network instance.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-mpls@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
        </figure>
      </section>

      <section title="BFD over MPLS-TE hierarchy">
        <t><xref target="I-D.ietf-teas-yang-te">YANG Data Model for TE
        Topologies </xref> is augmented. BFD is configured per MPLS-TE tunnel,
        and BFD session operational state data is provided per MPLS-TE
        LSP.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-mpls-te@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
        </figure>
      </section>

      <section title="Interaction with other YANG modules">
        <t><xref target="I-D.ietf-lime-yang-connectionless-oam">Generic YANG
        Data Model for Connectionless OAM protocols </xref> describes how the
        LIME connectionless OAM model could be extended to support BFD.</t>

        <t>Also, the operation of the BFD data model depends on configuration
        parameters that are defined in other YANG modules.</t>

        <section title="Module ietf-interfaces">
          <t>The following boolean configuration is defined in <xref
          target="I-D.ietf-netmod-rfc7223bis">A YANG Data Model for Interface
          Management </xref>: <list hangIndent="8" style="hanging">
              <t hangText="/if:interfaces/if:interface/if:enabled"><vspace/>If
              this configuration is set to "false", no BFD packets can be
              transmitted or received on that interface.</t>
            </list></t>
        </section>

        <section title="Module ietf-ip">
          <t>The following boolean configuration is defined in <xref
          target="I-D.ietf-netmod-rfc7277bis">A YANG Data Model for IP
          Management </xref>: <list hangIndent="8" style="hanging">
              <t
              hangText="/if:interfaces/if:interface/ip:ipv4/ip:enabled"><vspace/>If
              this configuration is set to "false", no BFD IPv4 packets can be
              transmitted or received on that interface.</t>

              <t
              hangText="/if:interfaces/if:interface/ip:ipv4/ip:forwarding"><vspace/>If
              this configuration is set to "false", no BFD IPv4 packets can be
              transmitted or received on that interface.</t>

              <t
              hangText="/if:interfaces/if:interface/ip:ipv6/ip:enabled"><vspace/>If
              this configuration is set to "false", no BFD IPv6 packets can be
              transmitted or received on that interface.</t>

              <t
              hangText="/if:interfaces/if:interface/ip:ipv6/ip:forwarding"><vspace/>If
              this configuration is set to "false", no BFD IPv6 packets can be
              transmitted or received on that interface.</t>
            </list></t>
        </section>

        <section title="Module ietf-mpls">
          <t>The following boolean configuration is defined in <xref
          target="I-D.ietf-mpls-base-yang">A YANG Data Model for MPLS Base
          </xref>: <list hangIndent="8" style="hanging">
              <t
              hangText="/rt:routing/mpls:mpls/mpls:interface/mpls:config/mpls:enabled"><vspace/>If
              this configuration is set to "false", no BFD MPLS packets can be
              transmitted or received on that interface.</t>
            </list></t>
        </section>

        <section title="Module ietf-te">
          <t>The following configuration is defined in the "ietf-te" YANG
          module <xref target="I-D.ietf-teas-yang-te">YANG Data Model for TE
          Topology </xref>: <list hangIndent="8" style="hanging">
              <t
              hangText="/ietf-te:te/ietf-te:tunnels/ietf-te:tunnel/ietf-te:config/ietf-te:admin-status"><vspace/>If
              this configuration is not set to "state-up", no BFD MPLS packets
              can be transmitted or received on that tunnel.</t>
            </list></t>
        </section>
      </section>

      <section title="IANA BFD YANG Module">
        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[<CODE BEGINS> file "iana-bfd-types@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/iana-bfd-types@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section anchor="BFD-TYPES" title="BFD types YANG Module">
        <t>This YANG module imports typedefs from <xref target="RFC6991"/>,  <xref target="RFC8177"/> and
        the "control-plane-protocol" identity from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-types@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-types@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD top-level YANG Module">
        <t>This YANG module imports and augments
        "/routing/control-plane-protocols/control-plane-protocol" from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD IP single-hop YANG Module">
        <t>This YANG module imports "interface-ref" from <xref
        target="I-D.ietf-netmod-rfc7223bis"/>, typedefs from <xref
        target="RFC6991"/> and augments
        "/routing/control-plane-protocols/control-plane-protocol" from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-ip-sh@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-ip-sh@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD IP multihop YANG Module">
        <t>This YANG module imports typedefs from <xref
        target="RFC6991"/> and augments
        "/routing/control-plane-protocols/control-plane-protocol" from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-ip-mh@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-ip-mh@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD over LAG YANG Module">
        <t>This YANG module imports "interface-ref" from <xref
        target="I-D.ietf-netmod-rfc7223bis"/>, typedefs from <xref
        target="RFC6991"/> and augments
        "/routing/control-plane-protocols/control-plane-protocol" from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-lag@YYYY-MM-DD.yang"

  INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-lag@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD over MPLS YANG Module">
        <t>This YANG module imports typedefs from <xref
        target="RFC6991"/> and augments
        "/routing/control-plane-protocols/control-plane-protocol" from <xref
        target="I-D.ietf-netmod-rfc8022bis"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-mpls@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-mpls@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>

      <section title="BFD over MPLS-TE YANG Module">
        <t>This YANG module imports and augments "/te/tunnels/tunnel" from
        <xref target="I-D.ietf-teas-yang-te"/>.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
<CODE BEGINS> file "ietf-bfd-mpls-te@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(../src/yang/ietf-bfd-mpls-te@YYYY-MM-DD.yang)

<CODE ENDS>
        ]]></artwork>
        </figure>
      </section>
    </section>

    <section title="Data Model examples">
      <t>This section presents some simple and illustrative examples on how to
      configure BFD.</t>

      <section title="IP single-hop">
        <t>The following is an example configuration for a BFD IP single-hop
        session. The desired transmit interval and the required receive
        interval are both set to 10ms.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/example-ip-sh.xml)  

]]></artwork>
        </figure>
      </section>

      <section title="IP multihop">
        <t>The following is an example configuration for a BFD IP multihop
        session group. The desired transmit interval and the required receive
        interval are both set to 150ms.</t>

        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/example-ip-mh.xml)
 ]]></artwork>
        </figure>
      </section>

      <section title="LAG">
        <t>The following is an example of BFD configuration for a LAG session.
        In this case, an interface named "Bundle-Ether1" of interface type
        "ieee802eadLag" has a desired transmit and required receive interval
        set to 10ms. </t>

        <t><figure>
            <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/example-lag.xml)

]]></artwork>
          </figure></t>
      </section>

      <section title="MPLS">
        <t>The following is an example of BFD configured for an MPLS LSP. In
        this case, the desired transmit and required receive interval set to
        250ms.</t>

        <t><figure>
            <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/example-mpls.xml)

]]></artwork>
          </figure></t>
      </section>
    </section>

    <section title="Security Considerations">
      <t>The YANG module specified in this document defines a schema for data
      that is designed to be accessed via network management protocols such as
      NETCONF <xref target="RFC6241"/> or RESTCONF <xref target="RFC8040"/>.
      The lowest NETCONF layer is the secure transport layer, and the
      mandatory-to-implement secure transport is Secure Shell (SSH) <xref
      target="RFC6242"/>. The lowest RESTCONF layer is HTTPS, and the
      mandatory-to-implement secure transport is TLS <xref
      target="RFC5246"/>.</t>

      <t>The NETCONF access control model <xref target="RFC6536"/> provides
      the means to restrict access for particular NETCONF or RESTCONF users to
      a preconfigured subset of all available NETCONF or RESTCONF protocol
      operations and content.</t>

      <t>There are a number of data nodes defined in this YANG module that are
      writable/creatable/deletable (i.e., config true, which is the default).
      These data nodes may be considered sensitive or vulnerable in some
      network environments. Write operations (e.g., edit-config) to these data
      nodes without proper protection can have a negative effect on network
      operations. These are the subtrees and data nodes and their
      sensitivity/vulnerability:</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-sh/sessions:
      the list specifies the IP single-hop BFD sessions.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-sh/sessions:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD IP single-hop session.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-mh/session-group:
      the list specifies the IP multi-hop BFD session groups.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-mh/session-group:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD IP multi-hop session.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/lag/sessions:
      the list specifies the BFD sessions over LAG.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/lag/sessions:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD over LAG session.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls/session-group:
      the list specifies the session groups for BFD over MPLS.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls/session-group:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD over MPLS LSPs session.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls/egress:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD over MPLS LSPs sessions for which this device is an MPLS LSP egress
      node.</t>

      <t>/te/tunnels/tunnel: data nodes local-multiplier,
      desired-min-tx-interval, required-min-rx-interval, min-interval and
      authentication all impact the BFD session over the MPLS-TE tunnel.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls-te/egress:
      data nodes local-multiplier, desired-min-tx-interval,
      required-min-rx-interval, min-interval and authentication all impact the
      BFD over MPLS-TE sessions for which this device is an MPLS-TE egress
      node.</t>

      <t/>

      <t>The YANG module has writeable data nodes which can be used for
      creation of BFD sessions and modification of BFD session parameters. The
      system should "police" creation of BFD sessions to prevent new sessions
      from causing existing BFD sessions to fail. For BFD session
      modification, the BFD protocol has mechanisms in place which allow for
      in service modification.</t>

      <t/>

      <t>Some of the readable data nodes in this YANG module may be considered
      sensitive or vulnerable in some network environments. It is thus
      important to control read access (e.g., via get, get-config, or
      notification) to these data nodes. These are the subtrees and data nodes
      and their sensitivity/vulnerability:</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-sh/summary:
      access to this information discloses the number of BFD IP single-hop
      sessions which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/ip-mh/summary:
      access to this information discloses the number of BFD IP multi-hop
      sessions which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/lag/micro-bfd-ipv4-session-statistics/summary:
      access to this information discloses the number of micro BFD IPv4 LAG
      sessions which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/lag/micro-bfd-ipv6-session-statistics/summary:
      access to this information discloses the number of micro BFD IPv6 LAG
      sessions which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls/summary:
      access to this information discloses the number of BFD sessions over
      MPLS LSPs which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>

      <t>/routing/control-plane-protocols/control-plane-protocol/bfd/mpls-te/summary:
      access to this information discloses the number of BFD sessions over
      MPLS-TE which are up, down and admin-down. The counters include BFD
      sessions for which the user does not have read-access.</t>
    </section>

    <section title="IANA Considerations">
      <t>The IANA is requested to as assign a new namespace URI from the IETF
      XML registry.</t>

      <t>This document registers the following namesace URIs in the IETF XML
      registry <xref target="RFC3688"/>:</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd-ip-sh</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd-mh</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd-lag</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd-mpls</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <t/>

      <t>--------------------------------------------------------------------</t>

      <t>URI: urn:ietf:params:xml:ns:yang:ietf-bfd-mpls-te</t>

      <t>Registrant Contact: The IESG.</t>

      <t>XML: N/A, the requested URI is an XML namespace.</t>

      <t>--------------------------------------------------------------------</t>

      <section title="IANA-Maintained iana-bfd-types module">
        <t>This document defines the initial version of the IANA-maintained
        iana-bfd-types YANG module.</t>

        <t>The iana-bfd-types YANG module mirrors the "BFD
        Diagnostic Codes" registry and "BFD Authentication Types" registry at
        https://www.iana.org/assignments/bfd-parameters/bfd-parameters.xhtml. 
        Whenever that registry changes, IANA must update the iana-bfd-types YANG module.</t>
      </section>
    </section>

    <section title="Acknowledgements">
      <t>We would also like to thank Nobo Akiya and Jeff Haas for their
      encouragement on this work. We would also like to thank Rakesh Gandhi
      and Tarek Saad for their help on the MPLS-TE model. We would also like
      to thank Acee Lindem for his guidance.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119"?>

      <?rfc include="reference.RFC.3688"?>

      <?rfc include='reference.RFC.5246'?>

      <?rfc include='reference.RFC.5880'?>

      <?rfc include='reference.RFC.5881'?>

      <?rfc include='reference.RFC.5882'?>

      <?rfc include='reference.RFC.5883'?>

      <?rfc include='reference.RFC.5884'?>

      <?rfc include='reference.RFC.5885'?>

      <?rfc include='reference.RFC.5586'?>

      <?rfc include='reference.RFC.6241'?>

      <?rfc include='reference.RFC.6242'?>

      <?rfc include='reference.RFC.6536'?>

      <?rfc include='reference.RFC.6991'?>

      <?rfc include='reference.RFC.7130'?>

      <?rfc include='reference.RFC.8040'?>

      <?rfc include="reference.RFC.8174"?>

      <?rfc include="reference.RFC.8177"?>

      <?rfc include="reference.I-D.ietf-netmod-rfc7223bis"?>

      <?rfc include="reference.I-D.ietf-netmod-rfc7277bis"?>

      <?rfc include='reference.I-D.ietf-netmod-rfc8022bis'?>

      <?rfc include="reference.I-D.ietf-mpls-base-yang"?>

      <?rfc include="reference.I-D.ietf-teas-yang-te"?>
         
      <?rfc include="reference.I-D.ietf-netmod-yang-tree-diagrams"?>
         
    </references>

    <references title="Informative References">
      <?rfc include="reference.I-D.ietf-rtgwg-ni-model"?>

      <?rfc include="reference.I-D.ietf-rtgwg-lne-model"?>

      <?rfc include="reference.I-D.ietf-lime-yang-connectionless-oam"?>

      <?rfc include="reference.I-D.ietf-netmod-revised-datastores"?>
    </references>

    <section anchor="ECHO-CONFIG" title="Echo function configuration example">
      <t>As mentioned in <xref target="IP-SH-CFG"/>, the mechanism to start
      and stop the echo function, as defined in <xref target="RFC5880"/> and
      <xref target="RFC5881"/>, is implementation specific. In this section we
      provide an example of how the echo function can be implemented via
      configuration.</t>

      <figure align="left">
        <preamble/>

        <artwork align="left"><![CDATA[
INSERT_TEXT_FROM_FILE(../src/yang/example-bfd-echo@YYYY-MM-DD-tree.txt)
                     ]]></artwork>
      </figure>

      <section title="Example YANG module for BFD echo function configuration">
        <figure align="left">
          <preamble/>

          <artwork align="left"><![CDATA[

INSERT_TEXT_FROM_FILE(../src/yang/example-bfd-echo@YYYY-MM-DD.yang)
        ]]></artwork>
        </figure>
      </section>
    </section>

    <section title="Change log">
      <t>RFC Editor: Remove this section upon publication as an RFC.</t>

      <section title="Changes between versions -11 and -12">
        <t><list style="symbols">
            <t>Addressed comments from YANG Doctor review of rev11.</t>
          </list></t>
      </section>

      <section title="Changes between versions -10 and -11">
        <t><list style="symbols">
            <t>Added 2 examples.</t>

            <t>Added a container around some lists.</t>
            
            <t>Fixed some indentation nits.</t>
          </list></t>
      </section>

      <section title="Changes between versions -09 and -10">
        <t><list style="symbols">
            <t>Addressed comments from YANG Doctor review.</t>

            <t>Addressed comments from WGLC.</t>
          </list></t>
      </section>

      <section title="Changes between versions -08 and -09">
        <t><list style="symbols">
            <t>Mostly cosmetic changes to abide by
            draft-ietf-netmod-rfc6087bis.</t>

            <t>Specified yang-version 1.1.</t>

            <t>Added data model examples.</t>

            <t>Some minor changes.</t>
          </list></t>
      </section>

      <section title="Changes between versions -07 and -08">
        <t><list style="symbols">
            <t>Timer intervals in client-cfg-parms are not mandatory
            anymore.</t>

            <t>Added list of interfaces under "ip-sh" node for authentication
            parameters.</t>

            <t>Renamed replay-protection to meticulous.</t>
          </list></t>
      </section>

      <section title="Changes between versions -06 and -07">
        <t><list style="symbols">
            <t>New ietf-bfd-types module.</t>

            <t>Grouping for BFD clients to have BFD multiplier and interval
            values.</t>

            <t>Change in ietf-bfd-mpls-te since MPLS-TE model changed.</t>

            <t>Removed bfd- prefix from many names.</t>
          </list></t>
      </section>

      <section title="Changes between versions -05 and -06">
        <t><list style="symbols">
            <t>Adhere to NMDA-guidelines.</t>

            <t>Echo function config moved to appendix as example.</t>

            <t>Added IANA YANG modules.</t>

            <t>Addressed various comments.</t>
          </list></t>
      </section>

      <section title="Changes between versions -04 and -05">
        <t><list style="symbols">
            <t>"bfd" node in augment of control-plane-protocol.</t>

            <t>Removed augment of network-instance. Replaced by
            schema-mount.</t>

            <t>Added information on interaction with other YANG modules.</t>
          </list></t>
      </section>

      <section title="Changes between versions -03 and -04">
        <t><list style="symbols">
            <t>Updated author information.</t>

            <t>Fixed YANG compile error in ietf-bfd-lag.yang which was due to
            incorrect when statement.</t>
          </list></t>
      </section>

      <section title="Changes between versions -02 and -03">
        <t><list style="symbols">
            <t>Fixed YANG compilation warning due to incorrect revision date
            in ietf-bfd-ip-sh module.</t>
          </list></t>
      </section>

      <section title="Changes between versions -01 and -02">
        <t><list style="symbols">
            <t>Replace routing-instance with network-instance from <xref
            target="I-D.ietf-rtgwg-ni-model">YANG Network Instances</xref></t>
          </list></t>
      </section>

      <section title="Changes between versions -00 and -01">
        <t><list style="symbols">
            <t>Remove BFD configuration parameters from BFD clients, all BFD
            configuration parameters in BFD</t>

            <t>YANG module split in multiple YANG modules (one per type of
            forwarding path)</t>

            <t>For BFD over MPLS-TE we augment MPLS-TE model</t>

            <t>For BFD authentication we now use <xref target="RFC8177">YANG
            Data Model for Key Chains</xref></t>
          </list></t>
      </section>
    </section>
  </back>
</rfc>
